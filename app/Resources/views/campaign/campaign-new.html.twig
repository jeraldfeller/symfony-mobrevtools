{% extends 'base.html.twig' %}
{% block stylesheets %}
    <link href="{{ asset('assets/global/plugins/select2/css/select2.min.css') }}" rel="stylesheet" type="text/css" />

    <link href="{{ asset('assets/global/plugins/select2/css/select2-bootstrap.min.css') }}" rel="stylesheet" type="text/css" />
    <link href="{{ asset('assets/global/plugins/bootstrap-daterangepicker/daterangepicker.min.css') }}" rel="stylesheet" type="text/css" />
    <link href="{{ asset('assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css') }}" rel="stylesheet" type="text/css" />
    <link href="{{ asset('assets/global/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css') }}" rel="stylesheet" type="text/css" />
    <link href="{{ asset('assets/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css') }}" rel="stylesheet" type="text/css" />
    <link href="{{ asset('assets/global/plugins/clockface/css/clockface.css') }}" rel="stylesheet" type="text/css" />
    <link href="{{ asset('assets/global/plugins/bootstrap-tagsinput/bootstrap-tagsinput.css') }}" rel="stylesheet" type="text/css" />
    <link href="{{ asset('assets/global/plugins/bootstrap-tagsinput/bootstrap-tagsinput-typeahead.css') }}" rel="stylesheet" type="text/css" />
    <style>
        .align-left{
            text-align: left !important;
            padding-left: 10px !important;
        }

        .margin-bottom-12{
            margin-bottom: 12px;
        }
    </style>
{% endblock %}
{% block nav %}
    {{ render(controller(
    'AppBundle:Navmenu:getNavmenu'
    )) }}
{% endblock %}
{% block body %}
    <h1 class="page-title"> {{ page }}

    </h1>
    <div class="page-bar">
        <ul class="page-breadcrumb">
            <li>
                <i class="icon-home"></i>
                <a href="/">Home</a>
                <i class="fa fa-angle-right"></i>
            </li>
            <li>
                <span>Campaign</span>
                <i class="fa fa-angle-right"></i>
            </li>
            <li>
                <span>{{ page }}</span>
            </li>

        </ul>
        <div class="page-toolbar">
            <div class="btn-group pull-right">
                <ul class="dropdown-menu pull-right" role="menu">
                    <li>
                        <a href="#">
                            <i class="icon-bell"></i> Action</a>
                    </li>
                    <li>
                        <a href="#">
                            <i class="icon-shield"></i> Another action</a>
                    </li>
                    <li>
                        <a href="#">
                            <i class="icon-user"></i> Something else here</a>
                    </li>
                    <li class="divider"> </li>
                    <li>
                        <a href="#">
                            <i class="icon-bag"></i> Separated link</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <!-- END PAGE HEADER-->

    <div class="row">
        <div class="col-lg-12">
            <div class="portlet light " id="form_wizard_1">
                <div class="portlet-title">
                    <div class="caption">
                        <i class=" icon-layers font-blue"></i>
                        <span class="caption-subject font-blue bold uppercase"> Form Wizard -
                                            <span class="step-title"> Step 1 of 4 </span>
                                        </span>
                    </div>
                    <div class="actions">
                        <a class="btn btn-circle btn-icon-only btn-default" href="javascript:;">
                            <i class="icon-cloud-upload"></i>
                        </a>
                        <a class="btn btn-circle btn-icon-only btn-default" href="javascript:;">
                            <i class="icon-wrench"></i>
                        </a>
                        <a class="btn btn-circle btn-icon-only btn-default" href="javascript:;">
                            <i class="icon-trash"></i>
                        </a>
                    </div>
                </div>
                <div class="portlet-body form">
                    <form class="form-horizontal" id="submit_form">
                        <div class="form-wizard">
                            <div class="form-body">
                                <ul class="nav nav-pills nav-justified steps">
                                    <li>
                                        <a href="#tab1" data-toggle="tab" class="step">
                                            <span class="number"> 1 </span>
                                            <span class="desc">
                                                                <i class="fa fa-check"></i> Offers Setup </span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#tab2" data-toggle="tab" class="step">
                                            <span class="number"> 2 </span>
                                            <span class="desc">
                                                                <i class="fa fa-check"></i> Landers Setup </span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#tab3" data-toggle="tab" class="step active">
                                            <span class="number"> 3 </span>
                                            <span class="desc">
                                                                <i class="fa fa-check"></i> Create Campaign </span>
                                        </a>
                                    </li>
                                </ul>
                                <div id="bar" class="progress progress-striped" role="progressbar">
                                    <div class="progress-bar progress-bar-success"> </div>
                                </div>
                                <div class="tab-content">
                                    <div class="alert alert-danger display-none">
                                        <button class="close" data-dismiss="alert"></button> You have some form errors. Please check below. </div>
                                    <div class="alert alert-success display-none">
                                        <button class="close" data-dismiss="alert"></button> Your form validation is successful! </div>
                                    <div class="tab-pane active" id="tab1">
                                        <h3 class="block">Create or Assign Offers</h3>
                                        <div class="form-group">
                                            <div class="col-md-9">
                                                <select class="form-control selectOffer" id="offers">
                                                    <option></option>
                                                    {% for offer in offers %}
                                                        <option
                                                                data-name="{{ offer.name }}"
                                                                data-url="{{ offer.url }}"
                                                                data-geo="{{ offer.geo }}"
                                                                data-payout="{{ offer.payout }}"
                                                                data-affiliate-network="{{ offer.affiliateNetwork }}"
                                                                value="{{ offer.id }}">{{ offer.name }}
                                                        </option>
                                                    {% endfor %}
                                                    </select>
                                            </div>
                                            <div class="col-md-3">
                                                <button type="button" id="assignOfferBtn" class="btn blue"><i class="fa fa-plus"></i> assign</button>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div id="appendOffers">

                                            </div>

                                            <div class="col-md-4 pull-left" >
                                                <button type="button" class="btn blue" id="addOfferBtn"><i class="fa fa-plus"></i> Add Offer</button>
                                            </div>
                                        </div>

                                        <h3 class="block">Assigned Offers</h3>
                                        <div class="form-group flip-scroll">
                                            <div class="col-md-12">
                                                <table class="table table-bordered table-striped table-condensed flip-content" id="assignOffersTbl">
                                                    <thead class="flip-content">
                                                    <tr>
                                                        <th> Name  </th>
                                                        <th> URL  </th>
                                                        <th> Geo  </th>
                                                        <th> Payout  </th>
                                                        <th> Affiliate Network  </th>
                                                        <th> Action </th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>

                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tab-pane" id="tab2">
                                        <h3 class="block">Create or Assign Landers</h3>
                                        <div class="form-group">
                                            <div class="col-md-9">
                                                <select class="form-control" id="landers">
                                                    <option></option>
                                                    {% for lander in landers %}
                                                        <option
                                                                data-name="{{ lander.name }}"
                                                                data-url="{{ lander.url }}"
                                                                data-geo="{{ lander.geo }}"
                                                                data-number-of-offers="{{ lander.numberOfOffers }}"
                                                                value="{{ lander.id }}">{{ lander.name }}
                                                        </option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                            <div class="col-md-3">
                                                <button type="button" id="assignLanderBtn" class="btn blue"><i class="fa fa-plus"></i> assign</button>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div id="appendLanders">

                                            </div>

                                            <div class="col-md-4 pull-left" >
                                                <button type="button" class="btn blue" id="addLanderBtn"><i class="fa fa-plus"></i> Add Lander</button>
                                            </div>
                                        </div>

                                        <h3 class="block">Assigned Landers</h3>
                                        <div class="form-group flip-scroll">
                                            <div class="col-md-12">
                                                <table class="table table-bordered table-striped table-condensed flip-content" id="assignLandersTbl">
                                                    <thead class="flip-content">
                                                    <tr>
                                                        <th> Name  </th>
                                                        <th> URL  </th>
                                                        <th> Offer </th>
                                                        <th> Geo  </th>
                                                        <th> Action </th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>

                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="tab-pane" id="tab3">
                                        <h3 class="block">Campaign Settings</h3>
                                        <div class="form-group">
                                            <div class="col-md-12">
                                                <input type="text" placeholder="Campaign Name" class="form-control" id="campaign_name">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-md-6">
                                                <select onchange="updateCostModel(this)" class="form-control selectTrafficSource" id="campaign_source">
                                                    <option></option>
                                                    {% for source in trafficSources %}
                                                        <option value="{{ source.id }}">{{ source.name }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <select class="form-control selectGeo" id="campaign_geo">
                                                    <option value="Global">Global</option>
                                                    {% for country in countries.countries %}
                                                        <option value="{{ country.code }}">{{ country.name }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-md-6">
                                                <select class="form-control selectCostModel" id="campaign_model">
                                                    <option></option>
                                                    <option value="NOT_TRACKED">Do Not Track</option>
                                                    <option value="CPC">CPC</option>
                                                    <option value="CPA">CPA</option>
                                                    <option value="CPM">CPM</option>
                                                    <option value="AUTO">AUTO</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <input type="text" placeholder="tags" class="form-control tags" id="campaign_tags" data-role="tagsinput" style="width: 100%;">
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <div class="col-md-6">
                                                <select class="form-control selectFlows" id="campaign_flow">
                                                    <option></option>
                                                    {% for flow in flows %}
                                                        <option data-rules="{{ flow.rules }}" value="{{ flow.id }}">{{ flow.name }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-6">
                                                <select class="form-control selectRules" id="selectRules">
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="form-actions">
                                <div class="row">
                                    <div class="col-md-offset-3 col-md-9">
                                        <a href="javascript:;" class="btn default button-previous">
                                            <i class="fa fa-angle-left"></i> Back </a>
                                        <a href="javascript:;" class="btn btn-outline green button-next"> Continue
                                            <i class="fa fa-angle-right"></i>
                                        </a>
                                        <a href="javascript:;" class="btn green button-submit"> Submit
                                            <i class="fa fa-check"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    </div>
{% endblock %}
{% block javascripts %}
    <script src="{{ asset('assets/global/plugins/autosize/autosize.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/select2/js/select2.full.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/moment.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/bootstrap-daterangepicker/daterangepicker.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/clockface/js/clockface.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/pages/scripts/components-date-time-pickers.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/jquery-validation/js/jquery.validate.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/jquery-validation/js/additional-methods.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/bootstrap-wizard/jquery.bootstrap.wizard.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/pages/scripts/form-wizard.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/bootstrap-tagsinput/bootstrap-tagsinput.min.js') }}" type="text/javascript"></script>

    <script>
        Ladda.bind( '.spinnerBtn' );
        $(document).on('ready', function () {
            $("#offers").select2({
                allowClear: true,
                placeholder: 'Select Offer',
                width: null
            });

            $("#landers").select2({
                allowClear: true,
                placeholder: 'Select Lander',
                width: null
            });


            $(".selectTrafficSource").select2({
                allowClear: true,
                placeholder: 'Select Traffic Source',
                width: null
            });


            $(".selectCostModel").select2({
                allowClear: true,
                placeholder: 'Select Cost Model',
                width: null
            });

            $(".selectFlows").select2({
                allowClear: true,
                placeholder: 'Select Flow',
                width: null
            });

            $(".selectRules").select2({
                allowClear: true,
                placeholder: 'Select Rules',
                width: null
            });

            $(".selectGeo").select2({
                allowClear: true,
                placeholder: 'Select Geo',
                width: null
            });


            $('.tags').tagsinput();

            // Assign Offers


            $assignedOffers = [];

            $('#assignOfferBtn').click(function(){
                $offerId = $('#offers').val();
                $offerName = $('#offers').find(':selected').data('name');
                $offerGeo = $('#offers').find(':selected').data('geo');
                $offerUrl = $('#offers').find(':selected').data('url');
                $offerPayout = $('#offers').find(':selected').data('payout');
                $offerAffiliateNetwork = $('#offers').find(':selected').data('affiliate-network');

               if($.inArray($offerId, $assignedOffers) == -1){
                   $assignedOffers.push($offerId);
                   $('#assignOffersTbl tbody').append(
                       '<tr>' +
                           '<td>' + $offerName + '</td>' +
                           '<td>' + $offerUrl + '</td>' +
                           '<td>' + $offerGeo + '</td>' +
                           '<td>' + $offerPayout + '</td>' +
                           '<td>' + $offerAffiliateNetwork + '</td>' +
                           '<td width="5%" class="align-center"> <button type="button" class="btn red btn-xs" data-is-new="0" data-id="'+$offerId+'" onClick="removeAssignedOffer(this)"><i class="fa fa-times"></i></td>' +
                       '</tr>'
                   );
               }else{
                   alert('Offer already assigned');
               }
            });



            // Assign Landers

            $assignedLanders = [];

            $('#assignLanderBtn').click(function(){
                $landerId = $('#landers').val();
                $landerName = $('#landers').find(':selected').data('name');
                $landerGeo = $('#landers').find(':selected').data('geo');
                $landerUrl = $('#landers').find(':selected').data('url');
                $landerNumberOfOffers = $('#landers').find(':selected').data('number-of-offers');

                if($.inArray($landerId, $assignedLanders) == -1){
                    $assignedLanders.push($landerId);
                    $('#assignLandersTbl tbody').append(
                        '<tr>' +
                        '<td>' + $landerName + '</td>' +
                        '<td>' + $landerUrl + '</td>' +
                        '<td>' + $landerNumberOfOffers + '</td>' +
                        '<td>' + $landerGeo + '</td>' +
                        '<td width="5%" class="align-center"> <button type="button" class="btn red btn-xs" data-is-new="0" data-id="'+$landerId+'" onClick="removeAssignedLander(this)"><i class="fa fa-times"></i></td>' +
                        '</tr>'
                    );
                }else{
                    alert('Lander already assigned');
                }
            });


            // Flows


            $('#campaign_flow').on('change', function(){
                $('#selectRules').empty();
                $id = $(this).val();
                $rulesSet = $(this).find(':selected').data('rules');

                $rules = $rulesSet.split(',');
                $.each($rules, function(i, val) {
                    $values = val.split('|')
                    $('#selectRules').append($('<option>', {
                        value: $values[0],
                        text: $values[1]
                    }));
                });
            });


        })
    </script>


    <script>
        var i = 0;
        var data = {items:[]};
        $('#addOfferBtn').click(function(){
            $('#appendOffers').append(
                '<div id="appendDivHolder_'+i+'" style="padding-bottom: 50px;">' +
                '<div class="col-md-2 col-sm-6">' +
                '<select class="form-control selectGeo" id="offer_geo_'+i+'">' +
                '<option value="Global">Global</option>' +
                {% for country in countries.countries %}
                '<option value="{{ country.code }}">{{ country.name }}</option>' +
                {% endfor %}
                '</select>' +
                '</div>' +
                '<div class="col-md-2 col-sm-6">' +
                '<input type="text" placeholder="Offer Name" class="form-control" id="offer_name_'+i+'">' +
                '</div>' +
                '<div class="col-md-2 col-sm-6">' +
                '<input type="text" placeholder="Offer Url" class="form-control" id="offer_url_'+i+'">' +
                '</div>' +
                '<div class="col-md-2 col-sm-6">' +
                '<select onChange="findLinkMatch(this)" data-index="'+i+'" class="form-control selectNetwork" id="offer_network_'+i+'" placeholder="Affiliate Network">' +
                {% for network in networks.affiliateNetworks %}
                '<option></option>' +
                '<option value="{{ network.id }}">{{ network.name }}</option>' +
                {% endfor %}
                '</select>' +
                '</div>' +
                '<div class="col-md-1 col-sm-6">' +
                '<input type="text" placeholder="Payout" class="form-control" id="offer_payout_'+i+'" onKeyPress="return isNumberKey(event)">' +
                '</div>' +
                '<div class="col-md-2 col-sm-6">' +
                '<select class="form-control selectPreset" id="offer_presets_'+i+'" placeholder="Presets">' +
                '<option value="" >No Preset</option>' +
                {% for preset in presets %}
                '<option value="{{ preset.presets }}">{{ preset.presetName }}</option>' +
                {% endfor %}
                '</select>' +
                '</div>' +
                '<div class="col-md-1">' +
                '<button type="button" class="btn blue" ' +
                'onclick="assignNewOffer(this)" data-index="'+i+'"><i class="fa fa-plus"></i></button>' +
                '</div>' +
                '</div>'
            );

            data.items.push({
                geo: 'offer_geo_'+i,
                name: 'offer_name_'+i,
                url: 'offer_url_'+i,
                network: 'offer_network_'+i,
                payout: 'offer_payout_'+i,
                preset: 'offer_presets_'+i

            });

            i++;


            $(".selectGeo").select2({
                allowClear: true,
                placeholder: 'Select Geo',
                width: null
            });



            $(".selectPreset").select2({
                allowClear: true,
                placeholder: 'Select Preset',
                width: null
            });


            $(".selectNetwork").select2({
                allowClear: true,
                placeholder: 'Select Affiliate Network',
                width: null
            });

        });
    </script>




    <script>
        var l = 0;
        var dataL = {items:[]};
        $('#addLanderBtn').click(function(){
            $('#appendLanders').append(
                '<div id="appendDivHolderLander_'+l+'" style="padding-bottom: 50px;">' +
                '<div class="col-md-2 col-sm-6">' +
                '<input type="text" placeholder="Lander Name" class="form-control" id="lander_'+l+'">' +
                '</div>' +
                '<div class="col-md-4 col-sm-6">' +
                '<input type="text" placeholder="Lander Url" class="form-control" id="lander_url_'+l+'">' +
                '</div>' +
                '<div class="col-md-1 col-sm-6">' +
                '<input type="text" placeholder="1 Offer" class="form-control" id="lander_offer_'+l+'">' +
                '</div>' +
                '<div class="col-md-2 col-sm-6">' +
                '<select class="form-control selectGeo" id="lander_geo_'+l+'">' +
                '<option value="Global">Global</option>' +
                    {% for country in countries.countries %}
                    '<option value="{{ country.code }}">{{ country.name }}</option>' +
                    {% endfor %}
                '</select>' +
                '</div>' +
                '<div class="col-md-2 col-sm-6">' +
                '<select class="form-control selectPreset" id="lander_presets_'+l+'" placeholder="Presets">' +
                '<option value="No Preset" >No Preset</option>' +
                    {% for preset in landerPresets %}
                    '<option value="{{ preset.presets }}">{{ preset.presetName }}</option>' +
                    {% endfor %}
                '</select>' +
                '</div>' +
                '<div class="col-md-1">' +
                '<button type="button" class="btn blue" ' +
                'onclick="assignNewLander(this)" data-index="'+l+'"><i class="fa fa-plus"></i></button>' +
                '</div>' +
                '</div>'
            );

            dataL.items.push({
                landerName: 'lander_'+l,
                landerUrl:  'lander_url_'+l,
                landerOffer:'lander_offer_'+l,
                landerGeo:  'lander_geo_'+l,
                landerPresets: 'lander_presets_'+l

            });

            l++;


            $(".selectGeo").select2({
                allowClear: true,
                placeholder: 'Select Geo',
                width: null
            });



            $(".selectPreset").select2({
                allowClear: true,
                placeholder: 'Select Preset',
                width: null
            });




        });
    </script>


   <script>
       function removeAssignedOffer(elem){

           $offerId = elem.getAttribute('data-id');
           $isNew = elem.getAttribute('data-is-new');

           if($isNew == 0){
               $assignedOffers.splice( $assignedOffers.indexOf($offerId), 1 );
               $(elem).parent().parent().remove();
           }else{
               $index = elem.getAttribute('data-index');
               console.log($index);
               $('#appendDivHolder_'+$index).fadeTo("fast",0.7, function(){
                   $('#appendDivHolder_'+$index).remove();
                   delete data.items[$index];
               });

               $assignedOffers.splice( $assignedOffers.indexOf($offerId), 1 );
               $(elem).parent().parent().remove();
           }


       }


       function removeAssignedLander(elem){

           $landerId = elem.getAttribute('data-id');
           $isNew = elem.getAttribute('data-is-new');

           if($isNew == 0){
               $assignedLanders.splice( $assignedLanders.indexOf($landerId), 1 );
               $(elem).parent().parent().remove();
           }else{
               $index = elem.getAttribute('data-index');
               console.log($index);
               $('#appendDivHolderLander_'+$index).fadeTo("fast",0.7, function(){
                   $('#appendDivHolderLander_'+$index).remove();
                   delete data.items[$index];
               });

               $assignedLanders.splice( $assignedLanders.indexOf($landerId), 1 );
               $(elem).parent().parent().remove();
           }


       }

       function assignNewOffer(elem){
           var i = elem.getAttribute('data-index');
           var isExists = false;
           $('#assignOffersTbl tbody tr').each(function(){
               console.log($(this).find('td:eq(0)').text());
               if($(this).find('td:eq(0)').text() == $('#offer_name_'+i).val()){
                   isExists = true;
               }
           })

           if(isExists == false){
               $('#assignOffersTbl tbody').append(
                   '<tr>' +
                   '<td data-is-new="1" data-name="'+$('#offer_name_'+i).val()+'"' +
                       'data-url="' + $('#offer_url_'+i).val() + $('#offer_presets_'+i).val() + '" ' +
                       'data-geo="'+$('#offer_geo_'+i).val()+'" ' +
                       'data-payout="' + $('#offer_payout_'+i).val() + '" ' +
                       'data-network="' + $('#offer_network_'+i).val() + '"> ' + $('#offer_name_'+i).val() + ' </td>' +
                   '<td>' + $('#offer_url_'+i).val() + $('#offer_presets_'+i).val() + '</td>' +
                   '<td>' + $('#offer_geo_'+i).val() + '</td>' +
                   '<td>$' + $('#offer_payout_'+i).val() + '</td>' +
                   '<td>' + $('#offer_network_'+i+ '  option:selected').text() + '</td>' +
                   '<td width="5%" class="align-center"> <button type="button" class="btn red btn-xs" data-index="'+i+'" data-is-new="1" data-id="0" onClick="removeAssignedOffer(this)"><i class="fa fa-times"></i></td>' +
                   '</tr>'
               );
           }else{
               alert('Offer already assigned');
           }


       }


       function assignNewLander(elem){
           var i = elem.getAttribute('data-index');
           var isExists = false;
           $('#assignLandersTbl tbody tr').each(function(){
               console.log($(this).find('td:eq(0)').text());
               if($(this).find('td:eq(0)').text() == $('#lander_'+i).val()){
                   isExists = true;
               }
           })

           if(isExists == false) {
               $('#assignLandersTbl tbody').append(
                   '<tr>' +
                   '<td data-is-new="1"' +
                       'data-name="' + $('#lander_' + i).val() + '" '+
                       'data-url="'+ $('#lander_url_' + i).val() +'" '+
                       'data-preset="'+ $('#lander_presets_' + i).val() + '" '+
                       'data-offer="' + $('#lander_offer_' + i).val() + '" ' +
                       'data-geo="' + $('#lander_geo_' + i).val() + '" ' +
                   '> ' + $('#lander_' + i).val() + '</td>' +
                   '<td>' + $('#lander_url_' + i).val() + $('#lander_presets_' + i).val() + '</td>' +
                   '<td>' + $('#lander_offer_' + i).val() + '</td>' +
                   '<td>' + $('#lander_geo_' + i).val() + '</td>' +
                   '<td width="5%" class="align-center"> <button type="button" class="btn red btn-xs" data-index="' + i + '" data-is-new="1" data-id="0" onClick="removeAssignedLander(this)"><i class="fa fa-times"></i></td>' +
                   '</tr>'
               );
           }

       }

       function removeAppend(elem){
           var index = elem.dataset.index;

           $('#appendDivHolder_'+index).fadeTo("fast",0.7, function(){
               $('#appendDivHolder_'+index).remove();
               delete data.items[index];
           });
       }

       function findLinkMatch(elem){
           $index = elem.getAttribute('data-index');
           $affiliateNetwork = $('#offer_network_'+$index).val();

           executeFindLink($affiliateNetwork, $index);

       }

       function updateCostModel(elem){
           if(elem.value == '6530e6cb-9550-402c-be06-78c1bb388346'){
               $('#campaign_model').val('AUTO').trigger('change');
           }
       }

   </script>

    <!-- AJAX CALLS -->
    <script src="{{ asset('assets/ajax/offers/offers.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/ajax/campaign/campaign.js') }}" type="text/javascript"></script>

    <!-- END AJAX CALLS -->
{% endblock %}
